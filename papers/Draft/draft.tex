% !TEX TS-program = lualatex
% !TEX encoding = UTF-8 Unicode

\documentclass[12pt, letterpaper]{article}

%%BIBLIOGRAPHY- This uses biber/biblatex to generate bibliographies according to the
%%Unified Style Sheet for Linguistics
\usepackage[main=american, german]{babel}% Recommended
\usepackage{csquotes}% Recommended
\usepackage[backend=biber,
        style=unified,
        maxcitenames=3,
        maxbibnames=99,
        natbib,
        url=false]{biblatex}
\addbibresource{Dissertation.bib}
\setcounter{biburlnumpenalty}{100}  % allow URL breaks at numbers
% \setcounter{biburlucpenalty}{100}   % allow URL breaks at uppercase letters
% \setcounter{biburllcpenalty}{100}   % allow URL breaks at lowercase letters

%%TYPOLOGY
\usepackage[svgnames]{xcolor} % Specify colors by their 'svgnames', for a full list of all colors available see here: http://www.latextemplates.com/svgnames-colors
%\usepackage[compact]{titlesec}
%\titleformat{\section}[runin]{\normalfont\bfseries}{\thesection.}{.5em}{}[.]
%\titleformat{\subsection}[runin]{\normalfont\scshape}{\thesubsection}{.5em}{}[.]
\usepackage[hmargin=1in,vmargin=1in]{geometry}  %Margins          
\usepackage{graphicx}	%Inserting graphics, pictures, images 		
\usepackage{stackengine} %Package to allow text above or below other text, Also helpful for HG weights 
\usepackage{fontspec} %Selection of fonts must be ran in XeLaTeX or LuaLateX
\usepackage{amssymb} %Math symbols
\usepackage{amsmath} % Mathematical enhancements for LaTeX
\usepackage{setspace} %Linespacing
\usepackage{multicol} %Multicolumn text
\usepackage{enumitem} %Allows for continuous numbering of lists over examples, etc.
\usepackage{multirow} %Useful for combining cells in tablesbrew 
\usepackage{booktabs}
\usepackage{hanging}
\usepackage{fancyhdr} %Allows for the 
\pagestyle{fancy}
\fancyhead[L]{\textit{Draft}} 
\fancyhead[R]{\textit{\today}} 
\fancyfoot[L,R]{} 
\fancyfoot[C]{\thepage} 
\renewcommand{\headrulewidth}{0.4pt}
\setlength{\headheight}{14.5pt} % ...at least 14.49998pt
% \usepackage{fourier} % This allows for the use of certain wingdings like bombs, frowns, etc.
% \usepackage{fourier-orns} %More useful symbols like bombs and jolly-roger, mostly for OT
\usepackage[colorlinks,allcolors={black},urlcolor={blue}]{hyperref} %allows for hyperlinks and pdf bookmarks
% \usepackage{url} %allows for urls
% \def\UrlBreaks{\do\/\do-} %allows for urls to be broken up
\usepackage[normalem]{ulem} %strike out text. Handy for syntax
\usepackage{datetime2}
\usepackage{tcolorbox}
\usepackage{todonotes} % Creates todo marginalia
\usepackage{lineno}\linenumbers 

%%FONTS
\setmainfont{Libertinus Serif}
\setsansfont{Libertinus Sans}
\setmonofont[Scale=MatchLowercase]{Libertinus Mono}

%%PACKAGES FOR LINGUISTICS
%\usepackage{OTtablx} %Generating tableaux with using TIPA
% \usepackage[noipa]{OTtablx} % Use this one generating tableaux without using TIPA
%\usepackage[notipa]{ot-tableau} % Another tableau drawing packing use for posters.
% \usepackage{linguex} % Linguistic examples
% \usepackage{langsci-linguex} % Linguistic examples
\usepackage{langsci-gb4e} % Language Science Press' modification of gb4e
% \usepackage{langsci-avm} % Language Science Press' AVM package
\usepackage{tikz} % Drawing Hasse diagrams
% \usepackage{pst-asr} % Drawing autosegmental features
\usepackage{pstricks} % required for pst-asr, OTtablx, pst-jtree.
% \usepackage{pst-jtree} 	% Syntax tree draawing software
% \usepackage{tikz-qtree}	% Another syntax tree drawing software. Uses bracket notation.
\usepackage[linguistics]{forest}	% Another syntax tree drawing software. Uses bracket notation.
% \usepackage{ling-macros} % Various linguistic macros. Does not work with linguex.
% \usepackage{covington} % Another linguistic examples package.
\usepackage{leipzig} %	Offers support for Leipzig Glossing Rules

%%LEIPZIG GLOSSING FOR ZAPOTEC
\newleipzig{el}{el}{elder} % Elder pronouns
\newleipzig{hu}{hu}{human} % Human pronouns
\newleipzig{an}{an}{animate} % Animate pronouns
\newleipzig{in}{in}{inanimate} % Inanimate pronouns
\newleipzig{pot}{pot}{potential} % Potential Aspect
\newleipzig{cont}{cont}{continuative} % Continuative Aspect
\newleipzig{stat}{stat}{stative} % Stative Aspect
\newleipzig{and}{and}{andative} % Andative Aspect
\newleipzig{ven}{ven}{venative} % Venative Aspect
% \newleipzig{res}{res}{restitutive} % Restitutive Aspect
\newleipzig{rep}{rep}{repetitive} % Repetitive Aspect

%%TITLE INFORMATION
\title{TITLE}
\author{Mykel Loren Brinkerhoff}
\date{\today}

%%MACROS
\newcommand{\sub}[1]{\textsubscript{#1}}
\newcommand{\supr}[1]{\textsuperscript{#1}}
\providecommand{\lsptoprule}{\midrule\toprule}
\providecommand{\lspbottomrule}{\bottomrule\midrule}
\newcommand{\fittable}[1]{\resizebox{\textwidth}{!}{#1}}

\makeatletter
\renewcommand{\paragraph}{%
  \@startsection{paragraph}{4}%
  {\z@}{0ex \@plus 1ex \@minus .2ex}{-1em}%
  {\normalfont\normalsize\bfseries}%
}
\makeatother
\parindent=10pt


\begin{document}

%%If using linguex, need the following commands to get correct LSA style spacing
%% these have to be after  \begin{document}
    % \setlength{\Extopsep}{6pt}
    % \setlength{\Exlabelsep}{9pt}		%effect of 0.4in indent from left text edge
%%

%% Line spacing setting. Comment out the line spacing you do not need. Comment out all if you want single spacing.
%	\doublespacing
	\onehalfspacing

\begin{center}
     {\Large \textbf{On Residual H1 as a measure of voice quality}}
     \vspace{6pt}

     Mykel Loren Brinkerhoff \& Grant McGuire
\end{center}
%\maketitle
%\maketitleinst
\thispagestyle{fancy}

% \tableofcontents

\begin{abstract}
    text.
    \\
    Keywords:
\end{abstract}

%------------------------------------
\section{Introduction} \label{sec:Introduction}
%------------------------------------


%------------------------------------
\section{Santiago Laxopa Zapotec} \label{sec:SLZ}
%------------------------------------

Santiago Laxopa Zapotec is an Oto-manguean   

%------------------------------------
\section{Methodology} \label{sec:Methods}
%------------------------------------

%------------------------------------
\subsection{Elicitation} \label{sec:Elicitation}
%------------------------------------
Ten native speakers of SLZ (five female; five male) participated in a wordlist eliciation. Elication was done in the pueblo of Santiago Laxopa, Ixtlán, Oaxaca, Mexcio during the summer of 2022 on a Zoom H4n handheld recorder (16 bit, 44.5 Khz). 

The wordlist consisted of 72 items repeated three times each in isolation and the carrier sentence \textit{Shnia' X chonhe lhas} ``I say X three times''.\footnote{See Appendix 1 for wordlist} Between these 72 words, there were 11 words with breathy voice, 9 with rearticulated, 10 with checked voice, and 42 with modal. Thirteen of the seventy-two words were disyllabic and the majority contained the same phonation type. Of those thirteen only five words contained mixed voicing.

%------------------------------------
\subsection{Data Processing} \label{sec:Processing}
%------------------------------------

Each vowel from the target words in the carrier sentence condition was labeled following \citet{garellekAcousticDiscriminabilityComplex2020} for where the vowel began and ended. Each vowel from the word list was annotated for speaker, word, vowel, tone, voice quality, and utterance number. This labeling was conducted for each of the vowels located in the target word from the elicitation list from the carrier sentences.

These vowels were then extracted and fed into VoiceSauce for acoustic measuring \citep{shueVOICESAUCEProgramVoice2009}. Formants were measured using the Snack \citep{sjolanderSnackSoundToolkit2004} while the fundamental frequency (\textit{f0}) was measured using the STRAIGHT algorithm \citep{kawaharaInstantaneousfrequencybasedPitchExtraction1998}. Spectral slope measures were corrected for formants and bandwidths \citep{hansonGlottalCharacteristicsFemale1997,iseliAgeSexVowel2007}.

Because the data contains variables for the grand mean for the different acoustic measures and the means of each tenth of the vowel, the columns were rearranged into a new data frame where each tenth of a vowel’s acoustic measurement is located under a single variable with the name of the acoustic measure. 
This required the creation of a new variable called time. 
This results in 22890 rows of data
After rearranging the data outliers were removed. 
F0

Data was first grouped by speaker then the z-score was calculated for f0. 

If the absolute value of f0 was greater than 3, it was removed. This is because 99.7\% of the data in a normally distributed dataset lies within 3 SDs of the mean. Anything greater than 3 is likely an outlier and marked as such.
Formants
Data was again grouped by speaker, and Mahalanobis distance was calculated for F1 and F2. 
A Mahalanobis distance greater than 6 means that you are a likely outlierxc
This was done by taking the covariance and means of F1 and F2. This gives you a grouping based on the vowels’ formants. 
The Mahalanobis distance was calculated based on F1 and F2
The data was filtered by each vowel and then outliers were determined. 
Energy
If energy was equal to 0 it was converted to NA
I then took the log10  of energy across all datapoints because the data is left bounded by 0 and has a long right tail. 
After determining which items were outliers they were filtered out.

Standardization
The data was grouped by each speaker before calculating the z-scores.
Z-scores were calculated for each of the measures except for Strength of Excitation which was normalized according to \citet{garellekVoicingGlottalConsonants2021}
This was done to bring all measurements into the same scale to facilitate better comparisons across speakers for the same measures.
This measure works best. We are not trying to normalize the data but bring everything into the same frame of reference.

Calculating Residual H1*
First, a linear mixed effects model was generated with the z-scored H1* as the response variable and the z-scored energy as fixed effect. 
The uncorrelated interaction of z-scored energy by speaker was treated as random. 
This is also how residual H1 was calculated in the supplementary material from \citet{chaiH1H2Acoustic2022}.
The resulting residual H1 model’s energy factor was extracted
Residual h1 was added as a variable to the dataframe by taking the z-scored H1* and subtracting the product of the z-scored energy and the energy factor 

%------------------------------------
\subsection{Statistical Modeling} \label{sec:Statistics}
%------------------------------------

Each model was Acoustic measure \sim  Phonation*Position + Tone + (1|Speaker:Word:Iter) + (1|Vowel)

Acoustic measure represents either H1*-H2* (z-score), H1*-A3 (z-score), or residual H1* 
Phonation*Position is a fixed effect that accounts for the interaction between Phonation and Position
Tone is another fixed effect for the five different tones across the vowels
This needs to be separated for a few reasons
it makes sense for physical reasons
tone and phonation are so closely linked that we mostly cover our bases by only including the position interaction with phonation, which avoids perfectly collinear interactions
This was revealed by the rank deficiency that occurs when we cross Phonation with Tone. 
This also makes sense because there are several tone and phonation contrasts that we were not able to capture.
(1|Speaker:Word:Iter) is a random effect that accounts for the interaction between these Speaker, Word, and Utterance number.
This allows us to capture the fact that each speaker said the same words three times each 
(1|Vowel) is a random effect that captures the fact that each phonation occurred with different vowels. 
We also know that certain vowels could adversely affect the raw acoustic measures.

% ------------------------------------
\section{Results} \label{sec:Results}
% ------------------------------------

% ------------------------------------
\subsection{H1*-H2*} \label{sec:H1H2}
% ------------------------------------

\begin{table}[!h]
  \centering
  \caption{Results of the statistical model for H1*-H2*.}
  \label{tab:H1H2Results}
  \begin{tabular}{llllll}
    \lsptoprule
     & Estimate & Std. Error & df & t value & p-value \\ \hline
    \textit{Intercept} & 0.02819 & 0.1033 & 4.755 & 0.273 & 0.796 \\
    Breathy &&&&& \\
    Checked &&&&& \\
    Laryngealized &&&&& \\
    Position 2 &&&&& \\
    Position 3 &&&&& \\
    High tone &&&&& \\
    Low tone &&&&& \\
    Mid tone &&&&& \\
    Rising tone &&&&& \\
    Breathy:Position 2 &&&&& \\
    Checked:Position 2 &&&&& \\
    Laryngealized:Position 2 &&&&& \\
    Breathy:Position 3 &&&&& \\
    Checked:Position 3 &&&&& \\
    Laryngealized:Position 3 &&&&& \\
    \lspbottomrule
  \end{tabular}
\end{table}

% ------------------------------------
\subsection{H1*-A3} \label{sec:H1A3}
% ------------------------------------

\begin{table}[!h]
  \centering
  \caption{Results of the statistical model for H1*-A3.}
  \label{tab:H1A3Results}
  \begin{tabular}{llllll}
    \lsptoprule
     & Estimate & Std. Error & df & t value & p-value \\ \hline
    \textit{Intercept} & 0.02819 & 0.1033 & 4.755 & 0.273 & 0.796 \\
    Breathy &&&&& \\
    Checked &&&&& \\
    Laryngealized &&&&& \\
    Position 2 &&&&& \\
    Position 3 &&&&& \\
    High tone &&&&& \\
    Low tone &&&&& \\
    Mid tone &&&&& \\
    Rising tone &&&&& \\
    Breathy:Position 2 &&&&& \\
    Checked:Position 2 &&&&& \\
    Laryngealized:Position 2 &&&&& \\
    Breathy:Position 3 &&&&& \\
    Checked:Position 3 &&&&& \\
    Laryngealized:Position 3 &&&&& \\
    \lspbottomrule
  \end{tabular}
\end{table}

% ------------------------------------
\subsection{Residual H1*} \label{sec:ResidH1}
% ------------------------------------

\begin{table}[!h]
  \centering
  \caption{Results of the statistical model for Residual H1*.}
  \label{tab:H1H2Results}
  \begin{tabular}{llllll}
    \lsptoprule
     & Estimate & Std. Error & df & t value & p-value \\ \hline
    \textit{Intercept} & 0.02819 & 0.1033 & 4.755 & 0.273 & 0.796 \\
    Breathy &&&&& \\
    Checked &&&&& \\
    Laryngealized &&&&& \\
    Position 2 &&&&& \\
    Position 3 &&&&& \\
    High tone &&&&& \\
    Low tone &&&&& \\
    Mid tone &&&&& \\
    Rising tone &&&&& \\
    Breathy:Position 2 &&&&& \\
    Checked:Position 2 &&&&& \\
    Laryngealized:Position 2 &&&&& \\
    Breathy:Position 3 &&&&& \\
    Checked:Position 3 &&&&& \\
    Laryngealized:Position 3 &&&&& \\
    \lspbottomrule
  \end{tabular}
\end{table}

% ------------------------------------
\subsection{Model Comparison} \label{sec:Comparison}
% ------------------------------------


According to \citet{casellaStatisticalInference2002}, which is the gold standard for statistical inference in the statistics field, the best way to compare models is by comparing the AIC and the likelihood ratio between the models.
Using std error to compare models is prone to p-hacking and is heavily frowned upon by statisticians 
This was done by using the function lrtest() from the lmtest package and using the function AIC() from the base stat package
The model with the highest Log-Likelihood ratio and lowest AIC is the most robust. 

\begin{table}[!h]
  \centering
  \caption{log likelihood scores and AIC for the three statistical models.}
  \label{tab:Comparison}
  \begin{tabular}{lll}
    \lsptoprule
    Model & Log-Likelihood Ratio & AIC \\
    \hline
    H1-H2 model & -21716 & 43469.29 \\
    H1- A3 model & -19048 & 38134.12 \\
    Residual H1 model & -16113 & 32264.81 \\
    \lspbottomrule
  \end{tabular}
\end{table}

% ------------------------------------
\section{Discussion} \label{sec:Discussion}
% ------------------------------------



% ------------------------------------
\section{Conclusion} \label{sec:Conclusions}
% ------------------------------------


%------------------------------------
%BIBLIOGRAPHY
%------------------------------------

%\singlespacing
%\nocite{*}
\printbibliography[heading=bibintoc]

%-------------------------------------
\section*{Appendix 1: Elicitation word list}
%-------------------------------------

\end{document}